<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  <title>JS For Beginners</title>
  <link rel="stylesheet" href="style.css">
</head>

<body>
  <header>
    <h1>JS For Beginners</h1>
  </header>

  <section class="container">
    <form id="my-form" onsubmit="saveToLocalStorage(event)">
      <h1>Add User</h1>
      <div class="msg"></div>
      <div>
        <label for="name">Name:</label>
        <input type="text" id="name">
      </div>
      <div>
        <label for="email">Email:</label>
        <input type="text" id="email">
      </div>
      <input class="btn" type="submit" value="Submit">
    </form>

    <ul id="users"></ul>

    <!-- <ul class="items">
        <li class="item">Item 1</li>
        <li class="item">Item 2</li>
        <li class="item">Item 3</li>
      </ul> -->
  </section>
  <ul id='listOfUsers'></ul>

  <script>
    function saveToLocalStorage(event) {


      event.preventDefault();
      const name = event.target.name.value;
      const email = event.target.email.value;
      // localStorage.setItem('name', name);
      // localStorage.setItem('email', email);

      let myObj = {
        name,
        email
      };

      localStorage.setItem(myObj.email, JSON.stringify(myObj))

      let myObj_serialized = JSON.stringify(myObj);
      console.log(myObj_serialized);

      //localStorage.setItem("myObj", myObj_serialized);


      let myObj_deserialized = JSON.parse(localStorage.getItem("myObj"));

      //console.log(myObj_deserialized);

      showNewUserOnScreen(myObj)

    }

    function showNewUserOnScreen(User) {
      const parentNode = document.getElementById('listOfUsers');
      const childHTML = `<li id=${User.email}> ${User.name} - ${User.email} <button onclick=deleteUser('${User.email}')> Delete User </button> <button onclick=editUserDetails('${User.email}','${User.name}')>Edit User </button></li>`

      parentNode.innerHTML = parentNode.innerHTML + childHTML;
    }


    function editUserDetails(email, name) {

      document.getElementById('email').value = email;
      document.getElementById('name').value = name;
    

      deleteUser(email)
    }

    function deleteUser(email) {
      console.log(email)
      localStorage.removeItem(email);
      removeUserFromScreen(email);

    }

    function removeUserFromScreen(email) {
      const parentNode = document.getElementById('listOfUsers');
      const childNodeToBeDeleted = document.getElementById(email);

      parentNode.removeChild(childNodeToBeDeleted)
    }


  </script>
</body>

</html>